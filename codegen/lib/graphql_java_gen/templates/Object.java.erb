<%= render_license %>

package <%= package_name %>;

import com.google.gson.Gson;
import com.google.gson.GsonBuilder;
import com.google.gson.JsonElement;
import com.google.gson.JsonObject;
import poc.graphql.client.support.AbstractResponse;
import poc.graphql.client.support.Arguments;
import poc.graphql.client.support.Error;
import poc.graphql.client.support.AbstractQuery;
import poc.graphql.client.support.SchemaViolationError;
import poc.graphql.client.support.TopLevelResponse;
import poc.graphql.client.support.Input;
<% imports.each do |import| %>
  import <%= import %>;
<% end %>

import java.io.Serializable;
import java.util.ArrayList;
import java.util.List;
import java.util.Map;

            <% fields = type.fields(include_deprecated: include_deprecated) || [] %>
            <% fields.sort_by{ |field| field.name } %>
            <% class_name = type.object? ? type.name : "Unknown#{type.name}" %>
            <%= java_doc(type) %>
            public class <%= class_name %> extends AbstractResponse<<%= class_name %>> <%= java_implements(type) %>{
                public <%= class_name %>() {
                }

                public <%= class_name %>(JsonObject fields) throws SchemaViolationError {
                  for (Map.Entry<String, JsonElement> field : fields.entrySet()) {
                    String key = field.getKey();
                    String fieldName = getFieldName(key);
                    switch (fieldName) {
                      <% fields.each do |field| %>
                        case "<%= field.name %>": {
                          <% generate_build_output_code("field.getValue()", field.type) do |statements, expr| %>
                            <%= statements %>
                            responseData.put(key, <%= expr %>);
                          <% end %>
                          break;
                        }
                      <% end %>
                      case "__typename": {
                        responseData.put(key, jsonAsString(field.getValue(), key));
                        break;
                      }
                      
                      default: {
                        readCustomField(fieldName, field.getValue());
                      }
                    }
                  }
                }

                <% if type.object? && type.implement?("Node") %>
                    public <%= class_name %>(<%= scalars['ID'].non_nullable_type %> id) {
                      this();
                      optimisticData.put("id", id);
                    }
                <% end %>

                <% if type.object? %>
                    public String getGraphQlTypeName() {
                        return "<%= type.name %>";
                    }
                <% else %>
                    public static <%= type.name %> create(JsonObject fields) throws SchemaViolationError {
                        String typeName = fields.getAsJsonPrimitive("__typename").getAsString();
                        switch (typeName) {
                            <% type.possible_types.each do |possible_type| %>
                                case "<%= possible_type.name %>": {
                                    return new <%= possible_type.name %>(fields);
                                }
                            <% end %>
                            default: {
                                return new <%= class_name %>(fields);
                            }
                        }
                    }

                    public String getGraphQlTypeName() {
                        return (String) get("__typename");
                    }
                <% end %>

                <% fields.each do |field| %>
                    <%= java_doc(field) %>
                    <%= java_annotations(field) %>
                    public <%= java_output_type(field.type) %> get<%= field.classify_name %>() {
                      return (<%= java_output_type(field.type) %>) get("<%= field.name %>");
                    }

                    <% next if field.name == "id" && type.object? && type.implement?("Node") %>
                    public <%= class_name %> set<%= field.classify_name %>(<%= java_output_type(field.type) %> arg) {
                      optimisticData.put(getKey("<%= field.name %>"), arg);
                      return this;
                    }
                <% end %>

                  public boolean unwrapsToObject(String key) {
                    switch (getFieldName(key)) {
                      <% fields.each do |field| %>
                        case "<%= field.name %>": return <%= field.type.unwrap.object? %>;
                      <% end %>
                      default: return false;
                    }
                  }
            }

